import subprocess, sys
from pathlib import Path

def ensure_requirements_installed():
    req = Path(__file__).with_name("requirements.txt")
    if req.exists():
        try:
            # pip will skip already-satisfied packages; this is fast after first run.
            subprocess.check_call([sys.executable, "-m", "pip", "install", "-r", str(req)])
        except Exception as e:
            # Don't crash the server if pip fails; HF-only actions can still run.
            print(f"[actions bootstrap] pip install -r requirements.txt failed: {e}")

import subprocess, sys

def ensure_packages():
    pkgs = [
        "rasa-sdk==3.6.2",
        "sanic==21.12.2",
        "sanic-routing==0.7.2",
        "pydantic==1.10.15",
        "huggingface_hub==0.24.0",
        "kaggle==1.6.14",
        "requests>=2.31.0",
    ]
    for p in pkgs:
        try:
            __import__(p.split("==")[0].split(">=")[0].replace("-", "_"))
        except ImportError:
            subprocess.check_call([sys.executable, "-m", "pip", "install", p])

ensure_packages()

